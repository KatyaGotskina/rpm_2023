{% extends 'main.html' %}

{% block head %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/category_products.css') }}">
{% endblock %}
{% block content %}
<div class="search-box">
    <input type="text" id="product-search" class="form-control" placeholder="Поиск...">
</div>
<button style="
margin-top: 20px;
margin-left: 10px;
background-color: rgb(26, 91, 145);
border-color: white;
width: 100px;
"class="btn btn-primary" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasLeft" aria-controls="offcanvasLeft">Каталог</button>
<div class="container">
    <div class="main-part">
        {% if message %}
            <p style="font-size: 25px; color: rgb(170, 162, 162); padding-left: 440px">{{ message }}</p>
        {% endif %}
        <div class="row justify-content-center">
            {% for product in products %}
            <div class="col-lg-2 col-md-6 col-sm-12">
                <div class="product-card">
                    <div class="prod-image">
                        <a href="#" data-bs-toggle="modal" data-bs-target="#{{ product.id }}"><img src="{{ url_for('static', filename=product.image_path) }}"></a>
                    </div>
                    <div class="prod-details">
                        <a href="#" data-bs-toggle="modal" data-bs-target="#{{ product.id }}">{{ product.name }}</a>
                        <div class="bottom-details d-flex justify-content-between">
                            <p class="card-text">{{ product.weight }} кг</p>
                            <p class="card-text" style="font-size: 17px;">{{ product.price }} руб</p>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>
<script src="static/js/flask_app.js"></script>
<script>
    var products = JSON.parse('{{ products|tojson|safe }}');
    function filterProducts(searchText) {
        searchText = searchText.toLowerCase();
        var productCards = document.querySelectorAll('.product-card');

        productCards.forEach(function(productCard) {
            var productNameElement = productCard.querySelector('.prod-details a');
            var productName = productNameElement.textContent.toLowerCase();

            if (productName.includes(searchText)) {
                productCard.style.display = 'block';
            } else {
                productCard.style.display = 'none';
            }
        });
    }
    function onSearchInputChange() {
        var searchText = document.getElementById('product-search').value;
        filterProducts(searchText);
    }
    document.getElementById('product-search').addEventListener('input', onSearchInputChange);
</script>

{% endblock %}
